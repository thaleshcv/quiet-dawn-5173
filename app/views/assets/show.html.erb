<%= render "partials/flash_messages" %>
<div class="d-flex">
	<div class="flex-grow-1">
		<h2>
			<%= @asset.abbreviation %>
			<span class="ml-1 text-muted"><%= @asset.name %></span>
		</h2>
		<div class="small text-uppercase">
			Current price
			<strong class="text-muted">
				<%= @asset.current_price.present? ? number_to_currency(@asset.current_price.value) : "Not available" %>
			</strong>
			<span class="mx-2"></span>
			Updated at
			<strong class="text-muted">
				<%= @asset.current_price.present? ? I18n.l(@asset.current_price.date, format: :long) : "Not available" %>
			</strong>
		</div>
	</div>
	<ul class="list-group list-group-horizontal text-right">
		<li class="list-group-item">
			<span class="d-block text-uppercase">Quantity</span>
			<strong class="text-muted text-right">
				<%= @investment_totals.quantity %>
			</strong>
		</li>
		<li class="list-group-item">
			<span class="d-block text-uppercase">Total invested</span>
			<strong class="text-muted text-right">
				<%= number_to_currency(@investment_totals.total_invested) %>
			</strong>
		</li>
		<li class="list-group-item">
			<span class="d-block text-uppercase">Current value</span>
			<strong class="text-muted text-right">
				<% if @asset.current_price.present? %>
					<%= number_to_currency(@investment_totals.total_accumulated) %>
					(<%= gain_loss(@investment_totals.total_invested, @investment_totals.total_accumulated) %>)
				<% else %>
					Not available
				<% end %>
			</strong>
		</li>
	</ul>
</div>

<div class="my-2"></div>

<div class="d-flex justify-content-between align-items-center">
	<h2>Investments</h2>
	<%= link_to 'Add investment', new_investment_path(asset_id: @asset) %>
</div>

<div class="list-group">
	<%= render partial: "assets/investment", collection: @investments %>
</div>

<% if @investments.empty? %>
	<div class="alert alert-info">
		<strong>Info!</strong>
		You have no investments on this asset.
	</div>
<% end %>
